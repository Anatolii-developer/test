<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FAQ - Career Planning</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #97C194;
    }

    .hero {
      width: 100%;
      height: 700px;
      background: url('./assets/library/career-img.png') no-repeat center center/cover;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hero-title {
      color: #FFFFFF;
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      font-size: 64px;
      text-transform: uppercase;
      position: absolute;
      bottom: 40px;
      text-align: center;
    }

    .faq-section {
      width: 1110px;
      margin: 0 auto;
      background: white;
      border-radius: 24px;
      padding: 60px 100px;
      box-sizing: border-box;
      color: #414141;
    }

    .faq-section h2 {
      font-size: 40px;
      font-weight: 600;
      margin-bottom: 40px;
      color: #414141;
      text-align: center;
    }

    .faq-item {
      background-color: #FFEED9CC;
      border-radius: 16px;
      margin-bottom: 16px;
      padding: 20px 24px;
      cursor: pointer;
      font-weight: 700;
      font-size: 20px;
      color: #414141;
      transition: all 0.2s ease;
    }

    .faq-answer {
      font-weight: 400;
      font-size: 16px;
      margin-top: 12px;
      color: #414141;
    }

    .apply-button {
  width: 1110px;
  height: 212px;
  margin: 40px auto;
  background-color: white;
  border-radius: 24px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 40px;
  box-sizing: border-box;
  cursor: pointer;
  transition: background 0.3s ease;
  padding: 60px 100px;
}

.apply-button:hover {
  background-color: #f0f0f0;
}

.apply-text {
  font-family: 'Poppins', sans-serif;
  font-weight: 600;
  font-size: 40px;
  color: #414141;
}

.apply-img {
  width: 284px;
  height: 164px;
  object-fit: contain;
}

.apply-arrow {
  width: 64px;
  height: 64px;
}


.faq-answer { display: none; }
.faq-item.open .faq-answer { display: block; }


    @media (max-width: 1200px) {
      .faq-section, .apply-button {
        width: 90%;
        padding: 40px 30px;
      }
    }


  </style>
</head>
<body>
    <aside class="sidebar collapsed" id="sidebar">
    <div class="toggle-button" onclick="toggleSidebar()">
      <img src="assets/sidebar/arrow.svg" alt="Toggle" id="toggleArrow" />
    </div>
    <img class="logo" src="assets/sidebar/IPS Logo (2).svg" alt="Logo" id="logoExpanded" />
    <img class="logo-collapsed" src="assets/sidebar/IPS Logo (1).svg" alt="Logo Small" id="logoCollapsed" />
    <img class="profile" src="assets/profile-photo.png" alt="User" width="40" height="40" />
    <nav>
      <a href="profile.html"><img src="assets/sidebar/profile.svg" /><span>Про Мене</span></a>
      <a href="mycertificates.html"><img src="assets/sidebar/news.svg" /><span>Мої Сертифікати</span></a>
      <a href="career-faq.html"><img src="assets/sidebar/10.svg" /><span>Планування Кар'єри</span></a>
      <a href="library.html"><img src="assets/sidebar/3.svg" /><span>Бібліотека</span></a>
      <a href="my-courses.html"><img src="assets/sidebar/5.svg" /><span>Мої Курси</span></a>
      <a href="#"><img src="assets/sidebar/8.svg" /><span>Облік</span></a>
      <a href="#"><img src="assets/sidebar/4.svg" /><span>Здоров’я</span></a>
      <a href="#"><img src="assets/sidebar/9.svg" /><span>Фінанси</span></a>
      <a href="#"><img src="assets/sidebar/6.svg" /><span>Нерухомість</span></a>
      <a href="forum/index.html">
  <img src="assets/sidebar/forum.svg" alt="Форум"/>
  <span>Форум</span>
</a>
    </nav>
    <div class="logout">
      <img src="assets/sidebar/log-out.svg" alt="Logout Icon" width="20" height="20" />
      <span>Вийти з акаунту</span>
    </div>
  </aside>

  <div class="hero">
    <div class="hero-title">CAREER PLANNING</div>
  </div>

  <div class="faq-section">
    <h2>FAQ</h2>

    <div class="faq-item">
      Що таке менторство у психотерапевтичному середовищі?
      <div class="faq-answer">
       Менторство — це форма професійної підтримки, 
       коли досвідчений спеціаліст (ментор) супроводжує колегу на певному етапі його професійного становлення. 
       Це може стосуватися як етичних і професійних питань, так і особистісного розвитку в ролі психотерапевта.
      </div>
    </div>

    <div class="faq-item">
      Чим менторство відрізняється від супервізії?
      <div class="faq-answer">
        Супервізія зосереджена на роботі з клієнтськими випадками й етичними межами терапії. 
        Менторство — це більш широка взаємодія: розвиток професійної ідентичності, підтримка у виборі подальшого навчання, професійного шляху, балансі між особистим і професійним.
      </div>
    </div>

   <div class="faq-item">
    Чи буде в мене план дій із професійного розвитку під час роботи з ментором?
    <div class="faq-answer">
     Так, ментор допоможе структурувати запити та розробити реалістичний план: як у навчанні, так і в кар’єрному русі. 
     План може включати рекомендації щодо програм, публікацій, супервізій чи участі в професійних спільнотах.
    </div>
  </div>
    
  <div class="faq-item">
    Як виглядає робота з ментором?
    <div class="faq-answer" >
      Це регулярні зустрічі (онлайн або офлайн), у яких ви обговорюєте запити, виклики, сумніви, цілі. 
      Формат може бути як структурованим (за попереднім планом), так і відкритим — за потребою. Ментор не «вчить», а радше підтримує, спрямовує й ділиться досвідом.
    </div>
  </div>

  <div class="faq-item" >
    Хто може бути ментором?
    <div class="faq-answer" >Ментором зазвичай стає досвідчений фахівець, 
      який має не лише глибоку експертизу, а й етичну чутливість та бажання підтримувати розвиток інших. 
      У нашій спільноті ментори проходять спеціальну підготовку й відбираються з урахуванням запиту ментората.
    </div>
  </div>

  <div class="faq-item" >
    Скільки триває менторство?
    <div class="faq-answer" >Тривалість менторства визначається індивідуально — залежно від запиту, рівня підготовки та професійних цілей. Найчастіше процес триває від 3 до 6 місяців, проте можливі й довготривалі формати співпраці — до року і більше. Для досягнення відчутних змін у карʼєрі зазвичай потрібен час, тому менторство розглядається як процес, а не одноразова зустріч.
</div>
  </div>

  <div class="faq-item" >
    Чи є теми, які не входять у менторство?
    <div class="faq-answer" > Так. Менторство не замінює особисту терапію, супервізію або консультування з юридичних питань. У разі потреби ментор може порекомендувати відповідного спеціаліста.
</div>
  </div>

  <div class="faq-item" >
    Чи є різниця між менторством і наставництвом?
    <div class="faq-answer" > У нашому контексті ці терміни часто вживаються як синоніми. Проте «наставництво» іноді акцентує на передаванні досвіду, тоді як «менторство» більше про партнерство і рефлексивну підтримку.
</div>
  </div>

  <div class="faq-item" >
    Як відбувається добір ментора?
    <div class="faq-answer" ">Менторат заповнює анкету із запитами, після чого координатор проєкту пропонує кандидата, який відповідає тематиці запиту, стилю роботи та етапу розвитку ментората.
</div>
  </div>

  <div class="faq-item" >
    Що мені дасть менторство?
    <div class="faq-answer" ">Підтримку, зменшення почуття ізольованості, можливість ставити «незручні» питання, переосмислювати професійну ідентичність і отримувати зворотний зв’язок від колеги, який вже пройшов подібний шлях. Це безпека та розвиток одночасно.
</div>
  </div>

  <div class="faq-item" ">
    Як враховується робота з ментором в загальному обліку проходження супервізії?
    <div class="faq-answer" >Години роботи з ментором зараховуються до супервізійної практики та будуть відображатися в особистому кабінеті в “Обліку практики”.
</div>
  </div>

  <div class="faq-item" >
    Який смисл та значення має менторство для формування високопрофесійного спеціаліста в області ментального здоров’я та психологічної підтримки?
    <div class="faq-answer">Справжній професіонал з психологічного консультування в ідеалі мав би володіти наступними вміннями та поєднувати їх в своїй особистості:
вміння і навички працювати в консультативній роботі (психотерапевтична, психоаналітична, кризова і т.д.);
отримувати та надавати супервізію;
оволодіти мистецтвом менторства, тобто бути спроможним здійснювати управління власною карʼєрою і визначати свою професійну долю і навчати цьому учнів, початківців і колег. 
</div>
  </div>

  </div>
<div class="apply-button" onclick="location.href='career-application.html'">
  <div class="apply-text">Подати заявку</div>
  <img src="./assets/career-apply.png" alt="Apply Image" class="apply-img" />
  <img src="./assets/library/arrow.png" alt="Arrow Icon" class="apply-arrow" />
</div>

<div class="apply-button" id="mentorButton" style="display: none;" onclick="location.href='career-mentor-requests.html'">
  <div class="apply-text">Менторство</div>
  <img src="./assets/career-mentor.png" alt="Mentor Image" class="apply-img" />
  <img src="./assets/library/arrow.png" alt="Arrow Icon" class="apply-arrow" />
</div>

<div class="apply-button" id="supervisorButton" style="display: none;" onclick="location.href='career-supervisor-requests.html'">
  <div class="apply-text">Супервізори</div>
  <img src="./assets/supervision.png" alt="Supervisor Image" class="apply-img" />
  <img src="./assets/library/arrow.png" alt="Arrow Icon" class="apply-arrow" />
</div>


<script>
/* ---------- FAQ: загрузка и рендер ---------- */
(function () {
  const FAQ_API = '/api/career-faq'; // публичный список (isActive=true)
  let didRender = false;

  // Экранирование и переносы
  const escapeHtml = (s='') =>
    s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]));
  const nl2br = (s='') => s.replace(/\n/g, '<br/>');

  async function loadFaq() {
    try {
      const res = await fetch(FAQ_API, { credentials: 'include' });
      if (!res.ok) throw new Error('Failed to load FAQ');
      const items = await res.json();
      renderFaq(Array.isArray(items) ? items : []);
    } catch (err) {
      console.error('FAQ load error:', err);
    }
  }

  function renderFaq(items) {
    if (didRender) return; // защита от двойного рендера
    didRender = true;

    const section = document.querySelector('.faq-section');
    if (!section) return;

    // Удалим старые .faq-item (если были размечены статически)
    section.querySelectorAll('.faq-item').forEach(n => n.remove());

    items.forEach(it => {
      const wrap = document.createElement('div');
      wrap.className = 'faq-item';
      wrap.innerHTML = `
        ${escapeHtml(it.question || '')}
        <div class="faq-answer">${nl2br(escapeHtml(it.answer || ''))}</div>
      `;
      section.appendChild(wrap);
    });

    // Делегирование кликов: открытие/закрытие ответа
    section.addEventListener('click', (e) => {
      const item = e.target.closest('.faq-item');
      if (item && section.contains(item)) item.classList.toggle('open');
    });
  }

  document.addEventListener('DOMContentLoaded', loadFaq);
})();

// ---------- Helpers: extract roles from various payload shapes ----------
function extractRolesFromPayload(payload) {
  // 1) Straight fields
  if (!payload) return null;
  const direct =
    (payload.roles || payload.role) ||
    (payload.user && (payload.user.roles || payload.user.role));
  if (direct) return direct;

  // 2) Common alternates
  const alt =
    (payload.roleTitles || payload.roleTitle || payload.userRole || payload.userRoles);
  if (alt) return alt;

  // 3) Deep scan for arrays/strings that look like roles
  const acc = [];
  (function walk(x) {
    if (x == null) return;
    if (Array.isArray(x)) {
      x.forEach(walk);
      return;
    }
    if (typeof x === 'object') {
      // try common string fields first
      const candidate = x.name || x.title || x.label || x.role || x.value;
      if (typeof candidate === 'string') {
        const s = candidate.toLowerCase();
        if (
          s.includes('ментор') || s.includes('mentor') ||
          s.startsWith('супервізор') || s.startsWith('супервизор') || s.startsWith('supervisor')
        ) {
          acc.push(candidate);
          return;
        }
      }
      for (const k in x) walk(x[k]);
      return;
    }
    if (typeof x === 'string') {
      const s = x.toLowerCase();
      if (
        s.includes('ментор') || s.includes('mentor') ||
        s.startsWith('супервізор') || s.startsWith('supervisor')
      ) {
        acc.push(x);
      }
    }
  })(payload);
  return acc.length ? acc : null;
}

// Normalize any roles shape to an array of strings
function normalizeRolesToStrings(input) {
  const acc = [];
  const pushStr = (s) => {
    if (!s) return;
    // split combined values like "Ментор; Супервізор ІІ категорії"
    String(s).split(/[|,;/]+/).forEach(p => {
      const t = String(p).trim();
      if (t) acc.push(t);
    });
  };
  if (Array.isArray(input)) {
    input.forEach(r => {
      if (typeof r === 'string') {
        pushStr(r);
      } else if (r && typeof r === 'object') {
        pushStr(r.name || r.title || r.label || r.role || r.value);
      } else {
        pushStr(r);
      }
    });
  } else if (input && typeof input === 'object') {
    // single role object
    pushStr(input.name || input.title || input.label || input.role || input.value);
  } else {
    pushStr(input);
  }
  return acc;
}

/* ---------- Роли: показать нужные кнопки ---------- */
function showRoleButtonsByRoles(roles) {
  const list = normalizeRolesToStrings(roles).map(s => s.toLowerCase().trim());
  const flattened = list.join(' | ');
  console.log('🧩 roles (normalized):', flattened);

  const hasMentor = list.some(s => s.includes('ментор') || s.includes('mentor'));
  const hasSupervisor = list.some(s => {
    const t = s.replace(/^[\s\-–—]+/, ''); // trim leading symbols
    return t.startsWith('супервізор') || t.startsWith('супервизор') || t.startsWith('supervisor');
  });

  if (hasMentor) {
    const el = document.getElementById('mentorButton');
    if (el) el.style.display = 'flex';
  }
  if (hasSupervisor) {
    const el = document.getElementById('supervisorButton');
    if (el) el.style.display = 'flex';
  }
}


// 2) Профиль из бекенда
fetch("/api/users/profile", { method: "GET", credentials: "include" })
  .then(async (res) => {
    let data = null;
    try { data = await res.clone().json(); } catch {}
    console.log('👤 /api/users/profile status=', res.status, 'payload=', data);
    if (!res.ok) return;

    // Try to extract roles from this payload first
    let candidateRoles = extractRolesFromPayload(data);

    // If not found but have user id, try a second fetch to the user resource
    if (!candidateRoles && data && data.user && data.user._id) {
      try {
        const res2 = await fetch(`/api/users/${data.user._id}`, { credentials: 'include' });
        let data2 = null;
        try { data2 = await res2.clone().json(); } catch {}
        console.log('🔎 /api/users/:id status=', res2.status, 'payload=', data2);
        if (res2.ok) {
          candidateRoles = extractRolesFromPayload(data2);
        }
      } catch (e) {
        console.warn('⚠️ secondary roles fetch failed:', e);
      }
    }

    if (candidateRoles) {
      showRoleButtonsByRoles(candidateRoles);
    } else {
      console.warn('⚠️ roles не знайдено у відповіді профілю (ні в /profile, ні в /users/:id)');
    }
  })
  .catch(err => console.error("❌ fetch profile error:", err));
</script>

 <script src="script.js"></script>
</body>
</html>
